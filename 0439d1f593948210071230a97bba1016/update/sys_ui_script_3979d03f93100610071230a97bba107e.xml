<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_script">
    <sys_ui_script action="INSERT_OR_UPDATE">
        <active>false</active>
        <description/>
        <global>true</global>
        <ignore_in_now_experience>false</ignore_in_now_experience>
        <name>ScribeCode</name>
        <script><![CDATA[// wiat for the monaco editor to be ready
if(false){
document.addEventListener('DOMContentLoaded', function () {

    // A ui script running on Servicenow to add a keybinding to the script editor (monaco)
    // monaco.editor.addKeybindingRule({ ... }) is a function provided by the monaco editor
    // lets add a console.log when any key is pressed, show the key code and the key name
    /* example code to add keyboard shortcuts to the monaco editor */
    // lets add a console.log when ALT+Enter is pressed, then;
    // when ALT+Enter is pressed, show ghosted text as inline completions
    // add this to the gsft_main's window.monaco object
    // switch frame
    var scribeCurrentUrl = document.location.href;
    var typeOfMonaco = typeof monaco;
    console.log("checking if monaco is available on " + scribeCurrentUrl + "\n\n\nwhat is typeof monaco? " + typeOfMonaco);
    if (typeOfMonaco != "undefined") {
        monaco.editor.addEditorAction({
            id: "my-unique-id",
            label: "My Label!!!",
            keybindings: [monaco.KeyMod.Alt | monaco.KeyCode.Enter],
            precondition: null,
            keybindingContext: null,
            contextMenuGroupId: "navigation",
            contextMenuOrder: 1.5,
            run: function (ed) {
                var position = ed.getPosition();
                var line = position.lineNumber;
                // get the whole script
                var script = ed.getValue();
                var text = ed.getModel().getLineContent(line);
                console.log("ALT+Enter pressed, line: " + line + " text: " + text);
                var dialog = document.createElement("dialog");
                dialog.style.backgroundColor = "white";
                dialog.style.top = "0px";
                dialog.style.width = "80%";
                dialog.style.height = "80%";
                dialog.style.overflow = "auto";
                dialog.style.border = "1px solid black";
                dialog.style.zIndex = "9999";
                var innerHTML = "<h1>Comment to Code</h1>";
                innerHTML += "Instruction: " + text + "<br>";
                innerHTML += "<pre>" + script + "</pre>";
                // show a loading spinner
                innerHTML += "<div id='loading' style='display: none;'><img src='https://www.w3schools.com/w3css/img_lights.gif' alt='loading...'></div>";
                // add a button to try g_form.setValue('script', 'console.log("Hello World")');
                innerHTML += "<textarea id='suggestedText' style='width: 100%; height: 100px;'></textarea>";
                innerHTML += "<button id='setScriptButton'>Set Script</button>";
                innerHTML += "<button id='closeButton'>Close</button>";
                dialog.innerHTML = innerHTML;

                try {
                    var ga = new GlideAjax('ollama');
                    ga.addParam('sysparm_name', 'commentToCode');
                    ga.addParam('sysparm_instruction', text);
                    ga.addParam('sysparm_script', script);
                    ga.getXML(function (response) {
                        var answer = response.responseXML.documentElement.getAttribute('answer');
                        var suggestedText = dialog.querySelector("#suggestedText");
                        suggestedText.value = answer;
                    });
                } catch (e) {
                    console.log(e);
                }

                // now wait 4 seconds and hide the loading spinner
                //setTimeout(function () {
                //    var loading = dialog.querySelector("#loading");
                //    loading.style.display = "none";
                //}, 4000);
                // Append the dialog to the body
                document.body.appendChild(dialog);

                // Add event listener to close button
                var closeButton = dialog.querySelector("#closeButton");
                closeButton.addEventListener("click", function () {
                    dialog.close();
                });
                var setScriptButton = dialog.querySelector("#setScriptButton");
                setScriptButton.addEventListener("click", function () {
                    try {
                        //g_form.setValue('script', text + "/*FROM THE BUTTON*/"); // ghosted text
                        //g_form.setValue('script', 'console.log("Hello World")');
                        var suggestedText = dialog.querySelector("#suggestedText").value;
                        g_form.setValue('script', suggestedText);
                    } catch (e) {
                        console.log(e);
                    }
                    dialog.close();
                });

                // Show the dialog
                dialog.showModal();
            },
        });
    }

});
}]]></script>
        <script_name/>
        <sys_class_name>sys_ui_script</sys_class_name>
        <sys_created_by>jacebenson</sys_created_by>
        <sys_created_on>2024-02-18 08:13:40</sys_created_on>
        <sys_id>3979d03f93100610071230a97bba107e</sys_id>
        <sys_mod_count>3</sys_mod_count>
        <sys_name>ScribeCode</sys_name>
        <sys_package display_value="AI in a Box" source="0439d1f593948210071230a97bba1016">0439d1f593948210071230a97bba1016</sys_package>
        <sys_policy/>
        <sys_scope display_value="AI in a Box">0439d1f593948210071230a97bba1016</sys_scope>
        <sys_update_name>sys_ui_script_3979d03f93100610071230a97bba107e</sys_update_name>
        <sys_updated_by>jacebenson</sys_updated_by>
        <sys_updated_on>2025-01-03 08:12:44</sys_updated_on>
        <ui_type>0</ui_type>
        <use_scoped_format>false</use_scoped_format>
    </sys_ui_script>
</record_update>
